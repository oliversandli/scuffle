; scuffle.lisp
; A scrabble solver written in Common Lisp.
;
; Copyright Oliver C. Sandli <oliversandli@icloud.com> 2021

(ql:quickload :snakes)


; CONVERSION FUNCTIONS
(defun string-to-list (s)
  (coerce s 'list))

(defun list-to-string (l)
  ; `format' or `coerce' works.
  ; `coerce' is used here for continuity with `string-to-list'.
  ; (format nil "窿飑ㄣ镥蜚篝蜷铉┅孪烈普蚊陨衔ㄤ彐躅泸遽翦怙狎箝篝狎舡鲠飑祜镳蝈疱狒箝泔祆邈祜镳蝈疱狒箝泔祆邈篝狎舡鲠飑┅ㄤ彐躅箦舡蹭飙ㄡ椹㈨镤殒噌忉箦镱翳鲠祯弩轭噱犷翳轭溴弩轭嚅Б箦赳篝蜷铉麸扉篝濠祜镳骘轭骘轭滹箦翩铘ㄣ徜铘ㄣ狎岍┅铋飑ㄤ彐躅铘璀铘㈢弭翳轭溴帙蝻鳗帏ㄣ镬蹴瞟镦材扉篝囔Б矧铘ㄣ徜铘ㄣ狎飑э豸镦怙躅潴弪蝻颟ㄤ彐躅珏舡泔ㄢ㈢弭泔祯眍帏镦材扉篝噔Б磲疸狎灬礅溽颟铘颟猢ㄤ彐躅怡泔祗ㄢⅡ弭躜扉篝镦泔祯眍镦材扉篝噔Б戾è鏖漪戾铉翳ㄣ狎猢┅祜镳骘骝镯忮祜鏖漪泔祆邈ㄧ弭泔鳗┅ㄤ彐躅泔矧洵蜥铉篝狎孱洎㈡轭犰鲠祯弩忮赭邋犷轭沆蹁轭篝狎犷孱洧ㄩㄣ狎篝狎舂ㄣ狎孱洎磲疸狎灬礅溽扉篝ㄣ狎篝狎舂┅祜镳骘骝镯ㄣ徜篝狎舂麸ㄣ徜孱洎泔祆邈椹磲疸狎灬礅溽扉篝ㄣ徜篝狎舂┅祜镳骘骝镯ㄣ狎篝狎舂麸ㄣ狎孱洎泔祆邈椹┅用弦晌普蚊陨衔ㄤ彐躅泸遽翦磲ㄦ殪瀛钺礤磲疸狎灬礅溽ㄣ磲疸狎ю狎箦轭翦珏蹰镳后痨轸篝蜷铉悌┅蹰镳候遽洵骈戾扉铄骈戾钺礤┅ㄤ彐疳蜥礤翦滹踱戾黠蜾磲皙ㄣ蝈狒瀛磲Ⅲ泔蝈磲痼滹踱戾黠蜾磲甬豇簪┅ㄤ彐疳蜥礤翦趄轲戾黠蜾磲皙ㄣ蝈狒瀛磲Ⅲ泔蝈磲痼趄轲戾黠蜾磲甬豇簪┅ㄤ彐疳蜥礤翦滹踱戾戾趑弪磲皙ㄣ蝈狒瀛磲Ⅲ泔蝈磲痼滹踱戾戾趑弪磲甬豇簪┅ㄤ彐疳蜥礤翦趄轲戾戾趑弪磲皙ㄣ蝈狒瀛磲Ⅲ泔蝈磲痼趄轲戾戾趑弪磲甬豇簪┅ㄤ彐疳蜥礤翦戾趑弪鲠祯弩戾è梏磲脲栳箬翎忪濠祗Жū⑨彘秕祛篝颌ú溏ǔ⑩沩稷ù㈡桷鼯ǖ㈦ǜ㈥ūⅠ┅┅祜镳骘疳轵轭祗骘筱矧ㄣ狎疳轵滹祜镳骘轭篝蜷铉麸扉篝ㄣ徜疳轵┅滹箦翩ㄧ弭栳箬梏筱矧濠┅梏┅ㄤ彐躅轶磲瓠礤礅弪ㄣ镲蜾磲皓ㄩ礤礅弪泔矧磲呼弩у聃犰舂ㄤ彐躅戾趑弪筱矧弩黠蜾祜镳骘轭篝蜷铉麸扉篝黠蜾泔祆邈ㄧ弭栳箬戾趑弪鲠祯弩┅ㄤ彐躅泔矧洵筱矧弩ㄣ镲蜾螬祜镳骘轭泔矧潴泔祆邈ㄩㄩ蟓磲瓠礤礅弪滹踱戾戾趑弪磲皙ㄩㄩ蟓磲瓠礤礅弪趄轲戾戾趑弪磲皙暴┅ㄤ彐躅黠蜾筱矧黠蜾疳趑弪泔矧潴戾舄è祗戾趑弪筱矧弩黠蜾┅ㄣㄣ镲蜾筱矧弩泔矧潴┅筱矧祜镳骘轭祗骘轭泱篚í戛┅祜镳骘轭泔矧潴滹ㄩㄡ钿ㄩ蟓磲瓠礤礅弪滹踱戾黠蜾磲皙铒礤礅弪疳趑弪呼弩у聃犰┅箦赳筱矧í筱矧濠ㄩㄡ钿ㄩ蟓磲瓠礤礅弪趄轲戾黠蜾磲皙铒礤礅弪疳趑弪呼弩у聃犰┅箦赳筱矧í筱矧濠┅┅筱矧濠至躺牧陨衔普蚊陨衔ㄤ彐疳蜥礤翦溟泗轱钺蝙磲疸狎灬礅溽螬篝蜷铉麸扉篝篝蜷铉滹黝汜箦螬┅蹰镳候遽洵骈戾扉铄泔祆轭蟓筱蜥忖戾黠蜾蟓舶惫豇簪┅ㄤ彐躅轭溟泗轱钺蝙黠蜾韵南杯躞骢钽糸镱轭箦螋轭麸圉犰殇黠蜾蟓骝镯疳趑弪瞌铛礅弪痫箝糸镱黠蜾溟泗轱钺蝙呼弩у聃犰┅｜ㄤ彐躅珏铄蜥翦黠蜾疱蝽豸狒轱铙黠蜾戾è箢犭弩邯箢犭弩眭祠榄盹溴┅祜镳骘骝镯忮祜戾铉翳黠蜾狃疱钿箢犭弩虹孱弪狒矧眷轶箢犭弩吼弪眭翎糸镱ㄤ彐躅鲠扉洵黠蜾蟓骝镯疳趑弪ㄣ栳颦扉篝疳趑弪忪犷氕汨狎戾舄è痫镬蝈漉沐с镱汨狎扉篝洪铋糸犰鲠祯蝈盹鲥忪犷氕汨狎疳趑弪瞟烘蝻憝孱舂箢犭弩邯箢犭弩眭祠榄盹溴红轶舂ㄡ祆黠蜾箢犭弩虹孱弪狒矧眷轶箢犭弩吼弪眭翎糸镱痫镬戾铉翳疳趑弪瞟┅┅祜镳骘黠蜾轭犰飙黠蜾泔祆邈ㄩㄩ瞽溟泗轱钺蝙黠蜾黠蜾┅┅ㄤ彐躅栝玷弩舡筱矧轭绛黠蜾骝镯疳趑弪ㄣ栳颦扉篝泔矧潴疳趑弪忪犷氕汨狎㈡轭翳栝玷弩筱矧轭黠蜾骝镯疳趑弪睥蝈趱蝾骘蝽狒筱矧黠蜾泔矧潴戾è麸瓠筱矧Ж铋铋飑┅祜镳骘黠蜾轭鲠扉洵黠蜾蟓骝镯疳趑弪汨狎扉篝疳趑弪忪犷氕汨狎骘筱矧黠蜾筱矧黠蜾疳趑弪泔矧潴滹ㄩ筱矧ㄣ狎麸瓠筱矧濠箦赳麸瓠筱矧扉篝筱矧黠蜾泔矧潴┅┅麸瓠筱矧濠酉讨晌普蚊陨衔ㄤ彐躅骈钿痨狴狎遽戾趑弪螬戾è戾趑弪蟓戾戾铉翳戾趑弪螬┅祜镳骘骝镯忮祜ū戾趑弪蟓戾瞟滹ㄦ矧磲⒗Β飑祜镳骘骝镯忮祜ūō戾趑弪蟓戾飑滹戾è篝狎椹ㄥ钿ūǐ飑┅ㄦ矧磲岈岍狺Β篝狎孱篚怏羼戾趑弪篝狎ū孱洎┅┅┅ㄤ彐躅骛飙箦癍鲠扉箦箦癍溟蝈铛汨狎扉篝忪犷氕汨狎㈡轭犰痨狴徕戾沐祆轭箦骝镯麸戾铉翳汨狎扉篝蝈趱蝾骘蝽狒篝狎舡泔矧孱洵泔矧疳趑弪瞟戾舄箦癍戾戾铉翳箦瘵ㄣ屐祗祜镳骘骝镯忮祜ū箦癍戾瞟狃疱钿祜镳骘骝镯麸ō箦癍戾飑泔祆邈ㄩㄥ箦癍溟蝈蝻鳗扉篝扉篝铛椹扉篝铛ǐ飑篚怏羼箦ǐ飑┅扉篝扉篝铛愆扉篝ǐ飑铛愆篚怏羼箦ǐ飑┅┅┅骈祠弪秕轭鲠扉沐祆祜镳骘轭沐祆骘汊ㄣ秕铘忪犷氕汨狎ㄣ徜潋悌滹ㄩ矧汊戾铉翳汨狎扉篝┅汊戾铉翳ㄣ徜潋悌┅ㄣ秕铘忪犷氕汨狎ㄣ徜潋悌┅箦赳沐祆蝈盹鲥沐祆呼弩у聃犰┅┅沐祆螬ㄤ彐躅骈钿痨狴ㄢ镝蜾汨狎扉篝忪犷氕汨狎ㄦ矧磲⒚徙祯灬糸铉痨狴Β戾舄è犰飙沐祆祜镳骘蝻轭怙狎骘泔轭ㄢ泔祗怙狎洎骘蜚骝镯狃疱钿ㄦ痨箦癍鲠扉蝻蝻蜚汨狎扉篝忪犷氕汨狎狃疱钿ㄦ痨箦癍鲠扉泔с镬蜚汨狎扉篝忪犷氕汨狎┅ㄨ榄沐祆蟓筱矧弩祜镳骘沐祆轭犰飙沐祆泔祆邈ㄩ沐祆ㄨ殓桢篝筱矧轭绛黠蜾骝镯疳趑弪汨狎扉篝ㄣ镲蜾蜥铉ㄣ狎沐祆ㄣ徜沐祆┅ㄣ徜潋沐祆忪犷氕汨狎┅┅ㄣ狎箫螋栝沐祆蟓筱矧弩Ь弘妁с狎┅┅ㄤ彐躅骈钿痨狴溴怩ㄢ镝蜾汨狎扉篝忪犷氕汨狎ㄦ矧磲⒚徙祯灬糸铉痨狴Β戾舄è犰飙沐祆祜镳骘蝻轭怙狎骘泔轭ㄢ泔祗怙狎洎骘蜚骝镯狃疱钿ㄦ痨箦癍鲠扉蝻蝻蜚汨狎扉篝忪犷氕汨狎狃疱钿ㄦ痨箦癍鲠扉泔с镬蜚汨狎扉篝忪犷氕汨狎┅┅祜镳骘沐祆轭犰飙沐祆滹麒孱沐祆ㄦ矧磲沐祆狺Β沐祆ㄦ矧磲⑩弩黠蜾狺Βㄨ殓桢篝筱矧轭绛黠蜾骝镯疳趑弪汨狎扉篝ㄣ镲蜾蜥铉ㄣ狎沐祆ㄣ徜沐祆┅ㄣ徜潋沐祆忪犷氕汨狎┅┅┅ㄤ彐疳蜥礤翦忪犷氕汨狎＼ㄤ彐疳蜥礤翦怙狎洫ㄣ蝈狒瀛怙狎钡忪犷氕汨狎┅ㄤ彐疳蜥礤翦戾趑弪螵ㄤ彐疳蜥礤翦殇Жú博ǔ博ù博┅箦舡蹭扉篝屐屙孱趔怙狎洫戾趑弪螵殇ㄤ彐疳蜥礤翦痨狴ㄦ轭洵痨狴怙狎洫篝蜷铉麸扉篝汜簪忪犷氕汨狎┅ㄦ痨箦癍鲠扉Ж＼＼＼＼蝻Ж＼＼猢＼